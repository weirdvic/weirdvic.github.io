+++
title = "Жизненный цикл ресурсов в Terraform"
lastmod = 2023-07-21
tags = ["Terraform"]
draft = false
+++

## Как работает обновление ресурсов? {#как-работает-обновление-ресурсов}

По-умолчанию существующий ресурс удаляется, создаётся новый и все ссылки на старый ресурс заменяются ссылками на новый.


## Возможно ли изменить стандартный жизненный цикл? {#возможно-ли-изменить-стандартный-жизненный-цикл}

Да, существует несколько вариантов, например `create_before_destroy`, при котором порядок обновления изменяется: сначала создаётся новый ресурс, обновляются ссылки, а затем старый ресурс удаляется.

```hcl
lifecycle {
  create_before_destroy = true
}
```

Причина для использования такого порядка обновления: в определённых случаях ресурс может иметь иммутабельные зависимости, которые нельзя обновить без пересоздания. В таком случае стандартный жизненный цикл не сработает: сначала придётся пересоздать зависимые ресурсы, а только потом основной.
