+++
title = "Использование provisioners в Terraform"
lastmod = 2023-07-21
tags = ["Terraform"]
draft = false
+++

## Что такое поставщики (provisioners) {#что-такое-поставщики--provisioners}

Допустим мы создали виртуальную машину и нам необходимо передать ей какие-либо данные или запустить какую-либо команду, как это можно сделать средствами Terraform? Ответ: с использованием [provisioners](https://developer.hashicorp.com/terraform/language/resources/provisioners/syntax). Поставщики можно описать как плагин для Terraform, позволяющий выполнять некоторые задачи по конфигурации сервисов. Типичные задачи, для которых используются поставщики:

-   Запустить софт для управления конфигурациями, такой как [Ansible]({{< relref "20230523211109-ansible.md" >}}).
-   Скопировать файлы
-   Выполнить скрипт на удалённой машине


## Почему к provisioners рекомендуется прибегать только в самом крайнем случае? {#почему-к-provisioners-рекомендуется-прибегать-только-в-самом-крайнем-случае}

Поскольку поставщик может выполнять большой диапазон действий, практически невозможно отследить изменения в системе, произошедшие после срабатывания поставщика, так что в случае если можно обойтись средствами провайдера, следует так и поступать.


## Что такое "tainted resource" {#что-такое-tainted-resource}

Ресурс, который был успешно создан Terraform, но удалось выкатить.


## Для чего нужен `terraform taint`? {#для-чего-нужен-terraform-taint}

Команда `terraform taint resource.id` позволяет вручную отметить ресурс как сломаный, так что при следующем запуске `terraform apply` ресурс будет удалён и создан снова.
